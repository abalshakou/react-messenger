(this["webpackJsonpreact messenger"]=this["webpackJsonpreact messenger"]||[]).push([[0],{232:function(e,a,t){},233:function(e,a,t){"use strict";t.r(a);var n,i,s,r,c,l,m=t(0),j=t.n(m),o=t(18),d=t.n(o),u=(t(130),t(10)),b=t(302),O=t(44),g=t(299),h=Object(g.a)(n||(n=Object(O.a)(["\n  subscription onQueryMessage($filter: MessageFilter!) {\n    queryMessage(filter: $filter ) {\n     id\n        message\n        receiverMail\n        senderMail\n        timestamp\n    }\n  }\n"]))),v=Object(g.a)(i||(i=Object(O.a)(["\n  subscription {\n    queryUser(order: { desc: name }) {\n    id\n      name\n      email\n      lastVisit\n      messages {\n            id\n            message\n            receiverMail\n            senderMail\n            timestamp\n          }\n    }\n  }\n"]))),x=Object(g.a)(s||(s=Object(O.a)(["\n  mutation sendUser($name: String!, $email: String!) {\n    addUser(input: [{ name: $name, email: $email }]) {\n         user {\n           id\n           name\n           email\n         }\n    }\n  }\n"]))),f=Object(g.a)(r||(r=Object(O.a)(["\n  mutation updateUser($patch: UpdateUserInput!) {\n    updateUser(input: $patch) {\n         user {\n           id\n           lastVisit\n         }\n    }\n  }\n"]))),p=Object(g.a)(c||(c=Object(O.a)(["\n  mutation sendMessage($message: String!, $receiverMail: String!, $senderMail: String!, $timestamp: DateTime!) {\n    addMessage(input: [{ message: $message, receiverMail: $receiverMail, senderMail: $senderMail, timestamp: $timestamp  }]) {\n      message {\n         id\n          message\n          receiverMail\n          senderMail\n          timestamp\n      }\n    }\n  }\n"]))),M=(Object(g.a)(l||(l=Object(O.a)(["\n  mutation deleteMessage($filter: MessageFilter!) {\n    deleteMessage(filter: $filter )  {\n    msg\n    numUids\n    }\n  }\n"]))),t(7)),N=t(33),S=t(301),y=t(289),w=t(296),k=t(48),$=t.n(k),q=t(304),C=t(1),U=function(e){var a=e.login,t=e.users,n=Object(m.useState)(!0),i=Object(u.a)(n,2),s=i[0],r=(i[1],function(){k&&U&&j({variables:{name:k,email:U}}).then()}),c=Object(q.a)(x),l=Object(u.a)(c,2),j=l[0],o=(l[1].error,Object(m.useState)({name:"",email:""})),d=Object(u.a)(o,2),b=d[0],O=d[1],g=Object(m.useState)(""),h=Object(u.a)(g,2),v=h[0],f=h[1],p=function(e){O(Object(N.a)(Object(N.a)({},b),{},Object(M.a)({},e.target.name,e.target.value)))},k=b.name,U=b.email;return Object(C.jsxs)(y.a,{elevation:3,className:"paper",children:["User Details,",Object(C.jsx)("a",{href:"/",onClick:function(e){e.preventDefault(),a(s)},children:"has account?"}),Object(C.jsx)(w.a,{required:!0,id:"outlined-name",label:"Name",name:"name",value:k,onChange:p,variant:"outlined",style:{margin:10}}),Object(C.jsx)(w.a,{required:!0,id:"outlined-email-input",type:"email",label:"Email",name:"email",value:U,onChange:p,variant:"outlined",className:"text-area",style:{margin:10}}),Object(C.jsx)(S.a,{variant:"contained",onClick:function(){var e=b.name,a=b.email,n=t.some((function(e){return e.email===a}));e.length||f("Name is required"),$.a.isEmail(a)||f("Valid email is required"),n&&f("Email already in use, maybe you want to enter?"),e.length&&$.a.isEmail(a)&&!n&&(f(""),r(),localStorage.token=JSON.stringify(b))},style:{margin:15},children:"Register"}),Object(C.jsx)("div",{children:v})]})},E=function(e){var a=e.users,t=Object(m.useState)({name:"",email:""}),n=Object(u.a)(t,2),i=n[0],s=n[1],r=Object(m.useState)(""),c=Object(u.a)(r,2),l=c[0],j=c[1],o=Object(q.a)(f),d=Object(u.a)(o,1)[0],b=(i.name,i.email);return Object(C.jsxs)(y.a,{elevation:3,className:"paper",children:["Has account? Enter email",Object(C.jsx)(w.a,{required:!0,id:"outlined-email-input",type:"email",label:"Email",name:"email",value:b,onChange:function(e){s(Object(N.a)(Object(N.a)({},i),{},Object(M.a)({},e.target.name,e.target.value)))},variant:"outlined",className:"text-area",style:{margin:10}}),Object(C.jsx)(S.a,{variant:"contained",onClick:function(){i.name;var e=i.email,t=a.some((function(a){return a.email===e}));if($.a.isEmail(e)||j("Valid email is required"),$.a.isEmail(e)&&t){j("");var n=a.find((function(a){return a.email===e})).id;localStorage.token=JSON.stringify(i),function(e){d({variables:{patch:{filter:{id:e},set:{lastVisit:(new Date).toISOString()}}}}).then()}(n)}},style:{margin:15},children:"Log in"}),Object(C.jsx)("div",{children:l})]})},F=t(59),V=t.n(F),D=t(295),I=function(e){var a=e.senderMail,t=e.receiverMail,n=Object(m.useState)(""),i=Object(u.a)(n,2),s=i[0],r=i[1],c=Object(q.a)(p),l=Object(u.a)(c,2),j=l[0];l[1].error;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(D.a,{maxRows:8,minRows:2,rows:4,id:"standard-message",label:"Enter you message",name:"message",value:s,multiline:!0,onChange:function(e){return r(e.target.value)},style:{margin:10}}),Object(C.jsx)(S.a,{type:"button",onClick:function(){s&&(j({variables:{message:s,receiverMail:t,senderMail:a,timestamp:(new Date).toISOString()}}),r(""))},children:"Send"})]})},J=t(107),R=function(e){return Object(C.jsxs)(J.a,Object(N.a)(Object(N.a)({viewBox:"0 0 400 160",height:160,width:400,backgroundColor:"transparent"},e),{},{children:[Object(C.jsx)("circle",{cx:"150",cy:"86",r:"8"}),Object(C.jsx)("circle",{cx:"194",cy:"86",r:"8"}),Object(C.jsx)("circle",{cx:"238",cy:"86",r:"8"})]}))};R.metadata={name:"RioF",github:"clariokids",description:"Three Dots",filename:"ThreeDots"};var T=R,L=function(e){e.id;var a=e.name,t=e.email,n=e.lastVisit,i=JSON.parse(localStorage.getItem("token")),s=Object(m.useState)(i.email),r=Object(u.a)(s,1)[0],c=Object(b.a)(h,{variables:{filter:{senderMail:{in:[r]},receiverMail:{in:[t]},or:{senderMail:{in:[t]},receiverMail:{in:[r]}}}}}),l=c.loading,j=(c.error,c.data);return Object(m.useEffect)((function(){document.title="You in chat with ".concat(a)})),l?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("h3",{children:"Loading"}),Object(C.jsx)(T,{})]}):Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)("div",{className:"personal-chat",children:[Object(C.jsxs)("div",{className:"chats-header",children:[Object(C.jsxs)("div",{className:"back-button",children:[Object(C.jsx)("div",{className:"bar1"}),Object(C.jsx)("div",{className:"bar2"}),Object(C.jsx)("div",{className:"bar3"})]}),Object(C.jsxs)("div",{className:"user-typing",children:["You in chat with  ",Object(C.jsx)("strong",{children:a}),",  last viewed ",n?V()(n).fromNow():"never"]})]}),Object(C.jsxs)("div",{className:"all-messages",children:[j.queryMessage.map((function(e){return Object(C.jsxs)("div",{className:i.email===e.senderMail?"sender":"receiver",children:[Object(C.jsx)("div",{className:"sender-name",children:i.email!==t?e.senderMail:e.receiverMail}),e.message," ",Object(C.jsxs)("span",{className:"time",children:[" ",V()(e.timestamp).fromNow()]})]},e.id)})),Object(C.jsx)(I,{senderMail:r,receiverMail:t})]})]})})},z=function(e){var a=e.login,t=e.users,n=Object(m.useState)(""),i=Object(u.a)(n,2),s=i[0],r=i[1],c=Object(m.useState)(""),l=Object(u.a)(c,2),j=(l[0],l[1]),o=Object(m.useState)(!1),d=Object(u.a)(o,2),b=d[0],O=(d[1],JSON.parse(localStorage.getItem("token"))),g=function(e){r(e)},h=t.find((function(e){return e.email&&e.email===O.email})).name;return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)("div",{className:"chat-page",children:[Object(C.jsxs)("div",{className:"user-welcome",children:[Object(C.jsxs)("div",{className:"user-heading",children:[Object(C.jsxs)("h3",{children:["Hello, ",h||""," "]}),Object(C.jsxs)("h5",{children:["Total Users : ",t.length]}),Object(C.jsx)(S.a,{className:"leave",size:"small",variant:"outlined",onClick:function(){return localStorage.clear(),j(!0),void a(b)},children:"Exit"}),Object(C.jsx)(S.a,{className:"close",size:"small",variant:"outlined",onClick:function(){r("")},children:"Close chat"})]}),Object(C.jsx)("div",{className:"select-user",children:t.map((function(e){return e.email&&e.email!==O.email?Object(C.jsxs)("div",{className:"users",onClick:function(){return g(e)},children:[e.name,e.lastVisit?Object(C.jsxs)("span",{className:"time",children:[" ",V()(e.lastVisit).fromNow()]}):Object(C.jsx)(C.Fragment,{})]},e.id):Object(C.jsxs)("div",{className:"users saved-chat",onClick:function(){return g(e)},children:["Saved messages ",Object(C.jsx)("div",{className:"small",children:e.name})]},e.id)}))})]}),s?Object(C.jsx)(L,{id:s.id,name:s.name,email:s.email,lastVisit:s.lastVisit}):Object(C.jsx)("div",{})]})})},B=function(){var e=Object(m.useState)(!1),a=Object(u.a)(e,2),t=a[0],n=a[1],i=Object(b.a)(v).data;return i&&i.queryUser?localStorage.getItem("token")?Object(C.jsx)(z,{login:function(e){return n(e)},users:i.queryUser}):t?Object(C.jsx)(E,{users:i.queryUser}):Object(C.jsx)(U,{login:function(e){return n(e)},users:i.queryUser}):Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(y.a,{elevation:3,className:"paper",children:[Object(C.jsx)("h3",{children:"Loading "}),Object(C.jsx)(T,{})]})})},H=t(294),Y=t(297),Q=t(38),A=t(300),G=t(298),K=t(293),P="nameless-brook-310157.eu-central-1.aws.cloud.dgraph.io/graphql",W=new(t(109).a)({uri:"wss://".concat(P),options:{reconnect:!0}}),X=new G.a({uri:"https://".concat(P)}),Z=Object(K.a)((function(e){var a=e.query,t=Object(Q.e)(a);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),W,X),_=new Y.a({cache:new A.a,link:Z});var ee=function(){return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(H.a,{client:_,children:Object(C.jsx)(B,{})})})};t(232);d.a.render(Object(C.jsx)(j.a.StrictMode,{children:Object(C.jsx)(ee,{})}),document.getElementById("root"))}},[[233,1,2]]]);
//# sourceMappingURL=main.903b77e5.chunk.js.map